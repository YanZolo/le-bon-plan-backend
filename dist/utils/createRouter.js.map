{"version":3,"sources":["../../src/utils/createRouter.ts"],"names":["express","createRouter","routes","router","Router","forEach","route","method","toLowerCase","path","pre","createHandler","handler","responseStatus","req","res","result","status","json","e","name","message","stack","process","env","NODE_ENV"],"mappings":"AAAA,OAAOA,OAAP,MAAmD,SAAnD;AASA,OAAO,SAASC,YAAT,CAAsBC,MAAtB,EAA+C;AACpD,QAAMC,MAAc,GAAGH,OAAO,CAACI,MAAR,EAAvB;AACAF,EAAAA,MAAM,CAACG,OAAP,CAAgBC,KAAD,IAAW;AACxB,UAAMC,MAAM,GAAGD,KAAK,CAACC,MAAN,CAAaC,WAAb,EAAf;AACAL,IAAAA,MAAM,CAACI,MAAD,CAAN,CAAeD,KAAK,CAACG,IAArB,EAA2B,GAAG,CAAC,IAAIH,KAAK,CAACI,GAAN,IAAa,EAAjB,CAAD,EAAuBC,aAAa,CAACL,KAAD,CAApC,CAA9B;AACD,GAHD;AAIA,SAAOH,MAAP;AACD;AAED,OAAO,SAASQ,aAAT,CAAuB;AAC5BC,EAAAA,OAD4B;AAE5BC,EAAAA,cAAc,GAAG;AAFW,CAAvB,EAGW;AAChB,SAAO,OAAOC,GAAP,EAAqBC,GAArB,KAAuC;AAC5C,QAAI;AACF,YAAMC,MAAM,GAAG,MAAMJ,OAAO,CAACE,GAAD,EAAMC,GAAN,CAA5B;;AAEA,UAAIA,GAAG,KAAKC,MAAZ,EAAoB;AAClBD,QAAAA,GAAG,CAACE,MAAJ,CAAWJ,cAAX,EAA2BK,IAA3B,CAAgCF,MAAhC;AACD;AAEF,KAPD,CAOE,OAAOG,CAAP,EAAe;AACf,aAAOJ,GAAG,CAACE,MAAJ,CAAWE,CAAC,CAACF,MAAF,IAAY,GAAvB,EAA4BC,IAA5B,CAAiC;AACtCE,QAAAA,IAAI,EAAED,CAAC,CAACC,IAAF,IAAU,gBADsB;AAEtCC,QAAAA,OAAO,EAAEF,CAAC,CAACE,OAF2B;AAGtCJ,QAAAA,MAAM,EAAEE,CAAC,CAACF,MAAF,IAAY,GAHkB;AAItCK,QAAAA,KAAK,EAAEC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwCN,CAAC,CAACG,KAA1C,GAAkD;AAJnB,OAAjC,CAAP;AAMD;AACF,GAhBD;AAiBD","sourcesContent":["import express, { Request, Response, Router } from 'express';\nexport interface RoutesOptions {\n  path: string;\n  method: string;\n  pre?: Function[];\n  handler: Function; // temporary fixed with rule \"@typescript-eslint/ban-types\":\"off\" in eslintrc.json :/\n  responseStatus?: number;\n}\n\nexport function createRouter(routes: RoutesOptions[]) {\n  const router: Router = express.Router();\n  routes.forEach((route) => {\n    const method = route.method.toLowerCase();\n    router[method](route.path, ...[...(route.pre || []), createHandler(route)]);\n  });\n  return router;\n}\n\nexport function createHandler({\n  handler,\n  responseStatus = 200\n}: RoutesOptions) {\n  return async (req: Request, res: Response) => {\n    try {\n      const result = await handler(req, res);\n      \n      if (res !== result) {\n        res.status(responseStatus).json(result);\n      }\n      \n    } catch (e: any) {\n      return res.status(e.status || 500).json({\n        name: e.name || 'INTERNAL_ERROR',\n        message: e.message,\n        status: e.status || 500,\n        stack: process.env.NODE_ENV !== 'production' ? e.stack : null\n      });\n    }\n  };\n}\n\n // if (typeof result === 'object' || 'array') {\n      //  return res.status(responseStatus).json(result);\n      // }\n      // return JSON.parse(result);"],"file":"createRouter.js"}